<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realistic Water Ripple</title>
    <style>
        /* CSS to make the background fill the screen */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }

        .ripple-bg {
            width: 100vw;
            height: 100vh;
            /* Replace the URL below with your own image path */
            background-image: url('https://m.media-amazon.com/images/I/81FSS+MhhdL._AC_UF1000,1000_QL80_.jpg');
            background-size: cover;
            background-position: center;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="ripple-bg"></div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/sirxemic/jquery.ripples/dist/jquery.ripples-min.js"></script>

    <script>
    jQuery(document).ready(function($) {
        const $rippleArea = $('.ripple-bg');

        // Initialize the ripples plugin
        $rippleArea.ripples({
            resolution: 512,      // Higher resolution = smoother ripples
            perturbance: 0.04,    // Refraction intensity
            dropRadius: 20,       // Size of the ripple
            interactive: true     // Mouse movement triggers ripples
        });

        let rippleTimeout;
        let motionCheckInterval;
        let isPlaying = false;

        function resumeRipple() {
            if (!isPlaying) {
                $rippleArea.ripples('play');
                isPlaying = true;
            }

            clearTimeout(rippleTimeout);
            // clearInterval(motionCheckInterval);

            // Start checking for stillness after 900ms of no movement
            rippleTimeout = setTimeout(() => {
                startMotionCheck();
            }, 900); 
        }

        function startMotionCheck() {
            // Note: This logic monitors the internal canvas of the plugin to save CPU
            const canvas = $rippleArea.find('canvas')[0];
            if(!canvas) return;
            
            const ctx = canvas.getContext('webgl') || canvas.getContext('2d');
            let lastFrame;
            let stillCounter = 0;

            // motionCheckInterval = setInterval(() => {
            //     // If movement has stopped, pause the simulation to save battery/CPU
            //     if (isPlaying) {
            //         stillCounter++;
            //         if (stillCounter >= 5) { 
            //             $rippleArea.ripples('pause');
            //             isPlaying = false;
            //             clearInterval(motionCheckInterval);
            //         }
            //     }
            // }, 200);
        }

        // Trigger ripple and resume simulation on mouse move
        $rippleArea.on('mousemove', function() {
            resumeRipple();
        });

        // Start paused to save resources until user interacts
        $rippleArea.ripples('pause'); 
    });
    </script>
</body>
</html>  